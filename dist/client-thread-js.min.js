/*! client-thread-js 22-03-2015 */
var thlibVersion = "1.0.4";
function threadJs(a){this.info="Version: "+thlibVersion+" by Matheus Silva matheus@mugfoundation.com";for(var b=0;b<arguments.length;b++)switch(arguments[b]){case"no-queue-overrides":this.noQueueOverrides=!0;break;default:this.noOptions=!0}return this.maxThreads=a||!1,this.queue=[],this.runningThreads=[],this.spawnEventWrapper=new Event("ThreadReady"),this.stop=!1,this}var thlibVersion="1.0.4";threadJs.prototype.getDebugInfo=function(){var a="the current queue is:\n"+this.queue+"and there are currently "+this.runningThreads.length-1+" running threads\n"+this.runningThreads,b=new Blob([a]),c=window.URL.createObjectURL(b),d=document.createElement("div");d.id="debugDiv",d.style.display="none",document.body.appendChild(d),document.getElementById("debugDiv").innerHTML='<a href="'+c+'" download="debugInfo.txt" id="dbui">dl</a>',document.getElementById("dbui").click()},threadJs.prototype.handler=function(){var a=0;this.maxThreads===!1?(this.runningThreads[this.queue[a][2]]=new Worker(window.URL.createObjectURL(this.queue[a][0])),this.queue.splice(0,1),this.dispatchEvent(this.spawnEventWrapper),a+=1):this.runningThreads.length<=this.maxThreads&&(this.runningThreads[this.queue[a][2]]=new Worker(window.URL.createObjectURL(this.queue[a][0])),this.queue.splice(0,1),this.dispatchEvent(this.spawnEventWrapper),a+=1),this.lastPidInQueue=this.queue.length-1},threadJs.prototype.spawner=function(a,b,c){c=c||"text/javascript";var d=new Blob([a],c);if(this.item=[],this.item[0]=d,this.item[1]=b,this.item[2]=this.lastPidInQueue+1,this.item[3]=!1,b<this.queue.length&&this.noQueueOverride===!1||b>=this.queue.length)this.queue[b]=this.item;else if(this.noQueueOverride===!0){for(;b<this.queue.length;)b+=1;b>this.queue.length&&(this.queue[b]=this.item)}for(;this.stop!==!0||this.queue<=0;)this.handler()},threadJs.prototype.spawnByDownload=function(a){this.requestWrapper=new XMLHttpRequest,this.requestWrapper.onreadystatechange=this.doOn(),this.requestWrapper.open("GET",a,!0),this.requestWrapper.send(null)},threadJs.prototype.doOn=function(){4===this.requestWrapper.readyState&&(200===this.requestWrapper.status?this.spawner(this.requestWrapper.responseText):errCallback(this.requestWrapper.status))};